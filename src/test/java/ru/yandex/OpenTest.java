package ru.yandex;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.openqa.selenium.WebElement;
import ru.open.PageOpen;


public class OpenTest extends ru.WebDriverSettings {

    @Test
    public void checkOpenPageObject() throws InterruptedException {
        System.out.println(this.getClass().getName());
        chromeDriver.get("https://yandex.ru");

        PageObjectYandexSearch yandexSearch = new PageObjectYandexSearch(chromeDriver);
        PageOpen openRu = new PageOpen(chromeDriver);

        yandexSearch.find("Открытие");
        yandexSearch.waitPagerItems();

        boolean check = false;
        String openRuLink = "";
        for(WebElement we : yandexSearch.getListOfAllLinks()) {
            if (we.getAttribute("href").contains("https://www.open.ru")) {
                check = true;
                openRuLink = we.getAttribute("href");
                break;
            }
        }
        Assertions.assertTrue(check, "No 'https://www.open.ru' on page");

        chromeDriver.get(openRuLink);
        chromeDriver.manage().deleteAllCookies();

        WebElement exchangeBlock = openRu.getExchangeBlock();
        float buyDollar = openRu.getBuyDollar(exchangeBlock);
        float sellDollar = openRu.getSellDollar(exchangeBlock);

        System.out.println("Buy="+buyDollar);
        System.out.println("Sell="+sellDollar);

        Assertions.assertTrue(sellDollar > buyDollar, "sellDollar less than buyDollar");

    }

}
